<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard | Apex Institute</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="dashboard-layout">
        <aside class="sidebar">
            <div class="sidebar-brand">
                <i class="fas fa-graduation-cap"></i>
                <span>Apex Portal</span>
            </div>
            <ul class="nav-menu">
                <li><a href="#" class="active" onclick="showDashboardSection('overview')"><i
                            class="fas fa-th-large"></i> <span>Overview</span></a></li>
                <li><a href="#" onclick="showDashboardSection('academics')"><i class="fas fa-book-open"></i>
                        <span>Academics</span></a></li>
                <li><a href="#" onclick="showDashboardSection('fees')"><i class="fas fa-wallet"></i> <span>Fees &
                            Scholarship</span></a></li>
                <li><a href="#" onclick="showDashboardSection('results')"><i class="fas fa-poll"></i>
                        <span>Results</span></a></li>
                <li><a href="#" onclick="showDashboardSection('schedule')"><i class="fas fa-calendar-alt"></i>
                        <span>Schedule</span></a></li>
                <li><a href="#" onclick="showDashboardSection('mentor')"><i class="fas fa-comments"></i> <span>Mentor
                            Connect</span></a></li>
                <li style="margin-top: auto;"><a href="javascript:void(0)" onclick="logout()" class="logout-link"><i
                            class="fas fa-sign-out-alt"></i> <span>Logout</span></a></li>
            </ul>
        </aside>

        <main class="main-content">
            <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <div>
                    <h1 id="section-title">Dashboard Overview</h1>
                    <p id="current-date" style="color: var(--text-muted);"></p>
                </div>
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <button class="help-btn-circle" onclick="toggleAIChat()" title="Apex AI Help">
                        <i class="fas fa-robot"></i>
                    </button>
                    <div style="text-align: right;">
                        <h4 id="student-name-display">Abhishek Kumar</h4>
                        <p style="font-size: 0.8rem; color: var(--text-muted);">2024CS001</p>
                    </div>
                    <div id="student-initials-avatar"
                        style="width: 45px; height: 45px; background: #e2e8f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; color: var(--primary-color); cursor: pointer;"
                        onclick="toggleProfileModal()">
                        AK</div>
                </div>
            </header>

            <!-- Overview Section -->
            <div id="overview-section" class="dash-section">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #e0e7ff; color: #4338ca;"><i
                                class="fas fa-id-card"></i></div>
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.9rem;">Roll Number</p>
                            <h3 id="roll-number">2024CS001</h3>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #fef3c7; color: #d97706;"><i
                                class="fas fa-code-branch"></i></div>
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.9rem;">Branch</p>
                            <h3 id="branch-name">Computer Science</h3>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #dcfce7; color: #16a34a;"><i
                                class="fas fa-layer-group"></i></div>
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.9rem;">Semester</p>
                            <h3 id="current-semester">4th Semester</h3>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #fae8ff; color: #a21caf;"><i class="fas fa-star"></i>
                        </div>
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.9rem;">Credits Earned</p>
                            <h3 id="completed-credits">84 / 160</h3>
                        </div>
                    </div>
                </div>

                <div
                    style="background: var(--white); padding: 2rem; border-radius: 16px; box-shadow: var(--shadow-sm);">
                    <h3>Announcements</h3>
                    <ul style="margin-top: 1rem;">
                        <li style="padding: 1rem 0; border-bottom: 1px solid #f1f5f9;">
                            <strong>Mid-Semester Results Out!</strong><br>
                            <small color="var(--text-muted)">Check your results in the Results section.</small>
                        </li>
                        <li style="padding: 1rem 0; border-bottom: 1px solid #f1f5f9;">
                            <strong>Upcoming Hackathon</strong><br>
                            <small color="var(--text-muted)">Register for Code-A-Thon 2024 by next Friday.</small>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Academics Section -->
            <div id="academics-section" class="dash-section" style="display: none;">
                <!-- Main Academics View -->
                <div id="academics-main-view">
                    <h3 style="margin-bottom: 1.5rem">Current Semester Subjects</h3>
                    <div id="academics-grid" class="academics-grid">
                        <!-- Dynamic Subject Cards -->
                    </div>
                </div>

                <!-- Attendance Detail View -->
                <div id="attendance-detail-view" style="display: none;">
                    <div
                        style="background: var(--white); padding: 2rem; border-radius: 16px; box-shadow: var(--shadow-sm);">
                        <div
                            style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;">
                            <div>
                                <button class="submit-btn"
                                    style="width: auto; padding: 0.5rem 1rem; margin-bottom: 1rem; background: #f1f5f9; color: var(--text-main);"
                                    onclick="hideSubjectDetails()">
                                    <i class="fas fa-arrow-left"></i> Back
                                </button>
                                <h2 id="detail-subject-name" style="font-size: 1.8rem;">Subject Name</h2>
                                <p style="color: var(--text-muted)"><span id="detail-subject-code">CSXXX</span> | <span
                                        id="detail-faculty-name">Faculty Name</span></p>
                            </div>
                            <div style="text-align: right;">
                                <p style="color: var(--text-muted); font-size: 0.9rem;">Overall Attendance</p>
                                <h1 id="detail-attendance-pct" style="font-size: 2.5rem; color: var(--primary-color);">
                                    0%
                                </h1>
                            </div>
                        </div>

                        <h4 style="margin-bottom: 1.5rem">Last 20 Days History</h4>
                        <div id="attendance-history-grid" class="history-grid">
                            <!-- Dynamic History Items -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fees Section -->
            <div id="fees-section" class="dash-section" style="display: none;">
                <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #eef2ff; color: #4338ca;"><i
                                class="fas fa-receipt"></i></div>
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.85rem;">Total Fee</p>
                            <h3 id="total-fee">₹ 1,20,000</h3>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #ecfdf5; color: #059669;"><i
                                class="fas fa-check-circle"></i></div>
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.85rem;">Amount Paid</p>
                            <h3 id="paid-fee">₹ 75,000</h3>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #fff1f2; color: #e11d48;"><i class="fas fa-clock"></i>
                        </div>
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.85rem;">Pending Fee</p>
                            <h3 id="pending-fee">₹ 45,000</h3>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: #fef3c7; color: #d97706;"><i
                                class="fas fa-percent"></i></div>
                        <div>
                            <p style="color: var(--text-muted); font-size: 0.85rem;">Scholarship</p>
                            <h3 id="scholarship-pct">25% Waiver</h3>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 2rem; display: flex; align-items: center; gap: 1rem;">
                    <button id="pay-online-btn" class="submit-btn" style="width: auto; padding: 0.8rem 2rem;"
                        onclick="openPaymentModal()">
                        <i class="fas fa-credit-card"></i> Pay Online
                    </button>
                    <span id="fee-status-badge"
                        style="display: none; padding: 0.6rem 1.2rem; background: #dcfce7; color: #16a34a; border-radius: 50px; font-weight: 600;">
                        <i class="fas fa-check-circle"></i> No Dues
                    </span>
                </div>
            </div>

            <!-- Payment Modal -->
            <div id="paymentModal" class="login-container"
                style="display: none; position: fixed; top: 0; left: 0; width: 100%; z-index: 3000; background: rgba(15, 23, 42, 0.9);">
                <div class="login-card" style="max-width: 500px; padding: 2rem; flex-direction: column;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                        <h2 style="font-size: 1.25rem;">Secure Payment</h2>
                        <button onclick="closePaymentModal()"
                            style="font-size: 1.5rem; color: var(--text-muted);">&times;</button>
                    </div>

                    <div
                        style="background: #f8fafc; padding: 1rem; border-radius: 12px; margin-bottom: 2rem; text-align: center;">
                        <p style="color: var(--text-muted); font-size: 0.9rem;">Amount to Pay</p>
                        <h2 id="modal-pay-amount" style="color: var(--primary-color); font-size: 2rem;">₹ 45,000</h2>
                    </div>

                    <!-- Payment Methods -->
                    <div id="method-selection" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="payment-method-card" onclick="selectPaymentMethod('PhonePe')">
                            <i class="fas fa-mobile-alt" style="color: #6739b7;"></i>
                            <span>PhonePe</span>
                        </div>
                        <div class="payment-method-card" onclick="selectPaymentMethod('Google Pay')">
                            <i class="fab fa-google-pay" style="color: #4285F4; font-size: 2rem;"></i>
                            <span>GPay</span>
                        </div>
                        <div class="payment-method-card" onclick="selectPaymentMethod('Paytm')">
                            <i class="fas fa-wallet" style="color: #00BAF2;"></i>
                            <span>Paytm</span>
                        </div>
                        <div class="payment-method-card" onclick="selectPaymentMethod('Card')">
                            <i class="fas fa-credit-card" style="color: #1e293b;"></i>
                            <span>Card</span>
                        </div>
                    </div>

                    <!-- PIN Entry -->
                    <div id="pin-entry-section" style="display: none; text-align: center;">
                        <p style="margin-bottom: 1rem; color: var(--text-muted);">Paying via <strong
                                id="selected-method-name"></strong></p>
                        <form onsubmit="processPayment(event)">
                            <div class="form-group">
                                <label>Enter Security PIN</label>
                                <input type="password" id="payment-pin" placeholder="••••" maxlength="6"
                                    style="text-align: center; font-size: 1.5rem; letter-spacing: 5px;" required>
                            </div>
                            <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                                <button type="button" class="submit-btn"
                                    style="background: #e2e8f0; color: var(--text-main);"
                                    onclick="resetPaymentUI()">Back</button>
                                <button type="submit" id="pay-confirm-btn" class="submit-btn">Confirm Payment</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="results-section" class="dash-section" style="display: none;">
                <div
                    style="background: linear-gradient(rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.9)), url('images/exam-results.jpg') center/cover; padding: 3rem 2rem; border-radius: 16px; box-shadow: var(--shadow-sm); min-height: 400px; display: flex; flex-direction: column; justify-content: center;">
                    <h3 style="margin-bottom: 2rem; text-align: center; font-size: 1.8rem; color: var(--bg-dark);">
                        Semester Performance (GPA)</h3>
                    <div style="display: flex; gap: 2rem; flex-wrap: wrap; justify-content: center;">
                        <div
                            style="flex: 1; min-width: 180px; max-width: 220px; padding: 1.5rem; background: var(--white); border-radius: 12px; text-align: center; box-shadow: var(--shadow-md); border: 1px solid #e2e8f0;">
                            <p style="font-weight: 600; color: var(--text-muted);">Semester 1</p>
                            <h2 style="color: var(--primary-color); font-size: 2.5rem; margin-top: 0.5rem;">8.5</h2>
                        </div>
                        <div
                            style="flex: 1; min-width: 180px; max-width: 220px; padding: 1.5rem; background: var(--white); border-radius: 12px; text-align: center; box-shadow: var(--shadow-md); border: 1px solid #e2e8f0;">
                            <p style="font-weight: 600; color: var(--text-muted);">Semester 2</p>
                            <h2 style="color: var(--primary-color); font-size: 2.5rem; margin-top: 0.5rem;">8.2</h2>
                        </div>
                        <div
                            style="flex: 1; min-width: 180px; max-width: 220px; padding: 1.5rem; background: var(--white); border-radius: 12px; text-align: center; box-shadow: var(--shadow-md); border: 1px solid #e2e8f0;">
                            <p style="font-weight: 600; color: var(--text-muted);">Semester 3</p>
                            <h2 style="color: var(--primary-color); font-size: 2.5rem; margin-top: 0.5rem;">8.8</h2>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Schedule Section -->
            <div id="schedule-section" class="dash-section" style="display: none;">
                <div
                    style="background: var(--white); padding: 2rem; border-radius: 16px; box-shadow: var(--shadow-sm);">
                    <h3>Upcoming Classes</h3>
                    <div style="margin-top: 1.5rem;">
                        <div
                            style="display: flex; gap: 1rem; padding: 1rem; background: #f1f5f9; border-radius: 8px; margin-bottom: 1rem;">
                            <div style="font-weight: 700; color: var(--primary-color);">09:00 AM</div>
                            <div>
                                <strong>Artificial Intelligence</strong><br>
                                <small>Room 402 • Dr. Sarah Smith</small>
                            </div>
                        </div>
                        <div
                            style="display: flex; gap: 1rem; padding: 1rem; background: var(--white); border: 1px solid #f1f5f9; border-radius: 8px; margin-bottom: 1rem;">
                            <div style="font-weight: 700; color: var(--text-muted);">11:30 AM</div>
                            <div>
                                <strong>Software Engineering</strong><br>
                                <small>Room 105 • Prof. James Gossling</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mentor Connect -->
            <div id="mentor-section" class="dash-section" style="display: none;">
                <div class="chat-container">
                    <div
                        style="padding: 1rem; background: #f8fafc; border-bottom: 1px solid #e2e8f0; display: flex; align-items: center; gap: 10px;">
                        <div
                            style="width: 40px; height: 40px; background: var(--primary-color); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <div>
                            <strong>Dr. Robert Wilson</strong><br>
                            <small style="color: #22c55e;">Online</small>
                        </div>
                    </div>
                    <div class="chat-messages" id="chat-messages">
                        <div class="message received">
                            Hello Abhishek, how are your preparations for the semester exams going?
                        </div>
                    </div>
                    <form id="mentorChatForm" class="chat-input" onsubmit="sendMentorMessage(event)">
                        <input type="text" id="chatInput" placeholder="Type a message..." required
                            style="flex: 1; border: 1px solid #e2e8f0; padding: 0.8rem; border-radius: 8px; outline: none;">
                        <button type="submit" style="color: var(--primary-color); font-size: 1.25rem;"><i
                                class="fas fa-paper-plane"></i></button>
                    </form>
                </div>
            </div>

        </main>
    </div>

    <!-- Student Profile Modal -->
    <div id="profileModal" class="login-container"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; z-index: 4000; background: rgba(15, 23, 42, 0.9);">
        <div class="login-card" style="max-width: 700px; padding: 0; flex-direction: column; overflow: hidden;">
            <div style="background: var(--primary-color); color: white; padding: 2rem; position: relative;">
                <button onclick="toggleProfileModal()"
                    style="position: absolute; top: 1rem; right: 1rem; font-size: 2rem; color: white;">&times;</button>
                <div style="display: flex; align-items: center; gap: 1.5rem;">
                    <div id="profile-initials"
                        style="width: 80px; height: 80px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: 800; color: var(--primary-color);">
                        AK</div>
                    <div>
                        <h2 id="profile-full-name" style="font-size: 1.8rem; margin: 0;">Student Name</h2>
                        <p id="profile-roll" style="opacity: 0.9; margin: 0;">2024CS001</p>
                    </div>
                </div>
            </div>

            <div
                style="padding: 2.5rem; display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; background: var(--white);">
                <div class="profile-info-item">
                    <label
                        style="display: block; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Email
                        ID</label>
                    <span id="profile-email" style="font-weight: 600;">-</span>
                </div>
                <div class="profile-info-item">
                    <label
                        style="display: block; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Phone
                        Number</label>
                    <span id="profile-phone" style="font-weight: 600;">-</span>
                </div>
                <div class="profile-info-item">
                    <label
                        style="display: block; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Date
                        of Birth</label>
                    <span id="profile-dob" style="font-weight: 600;">-</span>
                </div>
                <div class="profile-info-item">
                    <label
                        style="display: block; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Blood
                        Group</label>
                    <span id="profile-blood" style="font-weight: 600;">-</span>
                </div>
                <div class="profile-info-item">
                    <label
                        style="display: block; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Father's
                        Name</label>
                    <span id="profile-father" style="font-weight: 600;">-</span>
                </div>
                <div class="profile-info-item">
                    <label
                        style="display: block; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Mother's
                        Name</label>
                    <span id="profile-mother" style="font-weight: 600;">-</span>
                </div>
                <div class="profile-info-item">
                    <label
                        style="display: block; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Religion</label>
                    <span id="profile-religion" style="font-weight: 600;">-</span>
                </div>
                <div class="profile-info-item">
                    <label
                        style="display: block; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px;">Caste</label>
                    <span id="profile-caste" style="font-weight: 600;">-</span>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Chat Widget -->
    <div id="aiChatWidget" class="ai-chat-widget" style="display: none;">
        <div class="ai-chat-header">
            <div style="display: flex; align-items: center; gap: 10px;">
                <div class="ai-bot-icon"><i class="fas fa-robot"></i></div>
                <span>Apex AI Help</span>
            </div>
            <button onclick="toggleAIChat()" style="color: white; font-size: 1.2rem;">&times;</button>
        </div>
        <div id="aiChatMessages" class="ai-chat-messages">
            <div class="message received">
                Hello! I'm your Apex Assistant. How can I help you today?
            </div>
        </div>
        <div id="aiTyping" class="ai-typing" style="display: none;">
            <span></span><span></span><span></span>
        </div>
        <form id="aiChatForm" class="ai-chat-input" onsubmit="sendAIMessage(event)">
            <input type="text" id="aiInput" placeholder="Ask about login, fees, etc..." required>
            <button type="submit"><i class="fas fa-paper-plane"></i></button>
        </form>
    </div>

    <script src="script.js"></script>
    <script>
        // Initialize Student Data
        document.addEventListener('DOMContentLoaded', () => {
            renderStudentDashboard();
            document.getElementById('current-date').innerText = new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
        });
    </script>
</body>

</html>